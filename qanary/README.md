# Qanary Framework examples

![](https://raw.githubusercontent.com/WDAqua/Qanary/master/doc/logo-qanary_s.png)

## What is Qanary?

[Qanary](https://github.com/WDAqua/Qanary) is a framework for Question Answering over Linked Data. It enables a modular architecture that allows to combine different NLP tools via Linked Data technologies in a flexible way. 

The framework is based on the idea of a sequence of microservices that are connected via a message bus. Each microservice is responsible for a specific task, such as named entity recognition, relation extraction, or query formulation. 

The microservices can be implemented in any programming language and can be combined in different ways to create a question answering pipeline.

### Qanary Pipeline

The [Qanary pipeline](https://github.com/WDAqua/Qanary) is an orchestration engine that connects the different Qanary components. It is responsible for sending the input question to the first component, storing the intermediate results from one component such that the next can query them, and collecting the final answer from the last component.

### Qanary Components

[Qanary components](https://github.com/WDAqua/Qanary-question-answering-components) are the individual microservices that are connected in the Qanary pipeline. Each component is responsible for a specific task, such as named entity recognition, relation extraction, or query formulation, etc. The components can be implemented in any programming language (Java and Python are preferred) and can be combined in different ways to create a question answering pipeline.

## How to run this example?

### Setup Ngrok

To run the Qanary pipeline, you need to **expose the different components to the internet**. We will use [ngrok](https://ngrok.com/) for this purpose.

1. Download and install [ngrok](https://ngrok.com/download)
2. Edit the file `ngrok.yml` as follows (`nano ~/.config/ngrok/ngrok.yml`):

```yaml
version: "3"
agent:
    authtoken: <auth-token>

tunnels:
  tunnel1:
    addr: 40120
    proto: http 

  tunnel2:
    addr: 40121
    proto: http

  tunnel3:
    addr: 40122
    proto: http
```

3. Start ngrok with the following command:

```bash
ngrok start --all
```

4. Copy the URLs of the tunnels `tunnel1`, `tunnel2`, and `tunnel3` to the respective components (`.env` files -> `SERVER_HOST`)

### Set up `.env` files for every component

Example `.env` file

```
SPRING_BOOT_ADMIN_URL=http://demos.swe.htwk-leipzig.de:40111
SPRING_BOOT_ADMIN_USERNAME=admin
SPRING_BOOT_ADMIN_PASSWORD=admin
SERVER_HOST=https://f877-2001-638-502-5009-00-1056.ngrok-free.app
SERVER_PORT=40122
SERVICE_NAME_COMPONENT=QE-Python-SPARQLExecuter
SERVICE_DESCRIPTION_COMPONENT=Executes a SPARQL query generated by the previous components
SPARQL_ENDPOINT=https://query.wikidata.org/bigdata/namespace/wdq/sparql
PRODUCTION=True
```


### Start the Qanary components via Docker compose

```
docker compose build && docker compose up
```

### Start the Qanary pipeline

Fortunately, we have a pre-built and deployed Qanary pipeline that you can use to test the components. You can access it here: [Qanary Pipeline](http://demos.swe.htwk-leipzig.de:40111/)

Test your questions via [this](http://demos.swe.htwk-leipzig.de:40111/) interface:

![](https://raw.githubusercontent.com/WSE-research/langgraph-examples/refs/heads/main/qanary/img/qanary-test.jpg)

### Making changes to the components

If you want to make changes to the components, you can do so by editing the respective files of the components. After making the changes, you can rebuild the Docker image and restart the components.

